Диодный мост
B1S +
Транзистор
BSS84 +
Оптопара вход
LTV-817S +
Контроллер
tiny25 +
Оптопара выход
CPC1016NTR +
Стабилитрон
TL431 +
Линейный регулятор
MC33269D-3.3 +




Ещё раз спасибо за все замечания. Третий вариант ТЗ, надеюсь последний. Прибор получается чуть более сложный. Постарался внести все комментарии в этот пост.

Нужно разработать (для мелкосерийного производства) и собрать (единицы штук) небольшое и несложное устройство - «колхозный выключатель» - далее КВ. Принцип работы показан на рисунке.

 (если не показывается, то схемка ещё и внизу, в аттаче)

Устройство КВ имеет два разъёма Х1 и Х2, от которых проводами подключается к двум уже существующим устройствам — БТ и УК.

Устройство БТ («большой телевизор») - некое устройство неизвестного назначения, с неизвестной схемой. В устройстве БТ есть печатная плата, на которой среди прочего есть две детали и 6 точек для подпайки. Деталь номер один — кнопка. При кратковременном нажатии, включает или выключает устройство БТ. Способ подключения кнопки неизвестен, но известно ограничение по потенциалу и максимальному току в нажатом положении. Известно что кнопка коммутирует постоянный ток, но полярность неизвестна. Деталь номер два — светодиод. Когда устройство БТ включено, он горит. Когда выключено — не горит. Известно что светодиод включается/выключается (электронным) ключом, и имеет только два состояния — включён или выключен (то есть ни при каких обстоятельствах светодиод не мигает, не регулируется с помощью ШИМ, итд).

Шесть точек на неизвестной плате в устройстве БТ:
1 — Земля.
2 — Питание Vext, от 4.8 до 14 вольт, «неограниченной» мощности.
3 — Анод светодиода, через резистор неизвестного номинала (возможно 0 ом)
4 — Катод светодиода, через резистор неизвестного номинала (возможно 0 ом)
5 —Контакт кнопки
6 —Контакт кнопки

Гарантируется, что в любой момент времени, потенциал на всех точках БТ (1-6) выше или равен GND и ниже или равен Vext.
Ток коммутируемый кнопкой БТ - не более 10 ма.

Устройство УК - «удалённый коммутатор». Устройство УК содержит гальванически развязанный источник переменного (или постоянного) тока. В случае переменного тока — напряжение 24в ±10% . В случае постоянного тока, 20-40 вольт, при этом полярность неизвестна. Максимальный ток, который может потреблять устройство КВ от источника питания в устройстве УК — 100ма .

Необходимо сделать устройство КВ. Это маленькая плата, на которой есть два разъёма Х1 (разъём под шлейф) и Х2 (клеммник). К разъёму Х1 подключается шлейф, уходящий к БТ. К разъёму Х2 подключается три провода от устройства УК. Устройство КВ занимается тем, что включает и выключает устройство БТ в зависимости от состояния выключателей SW1 и SW2 в устройстве УК. Включение и выключение устройства БТ происходит путём замыкания кнопки БТ (контактов 5 и 6) на 150 миллисекунд ±20%.

Логика работы устройства КВ:

1. ждём одну секунду, ничего не делаем (заряжаем конденсаторы, если нужно)
2. (несколько раз) опрашиваем состояние контактов EN и ONOFF на разъёме Х2, и состояние светодиода. Если выключатель SW1 (EN) разомкнут, то ничего не делаем. В противном случае, если светодиод горит а контакты SW2 (ONOFF) разомкнуты, ИЛИ светодиод не горит, а контакты SW2 (ONOFF) замкнуты, то «нажимаем кнопку» - замыкаем контакты 4 и 5 на 150 миллисекунд.
3. goto 1

Плата КВ будет максимально близко к БТ (встраиваться в корпус БТ). Желательные габариты - "маленькая и длинная", с одной стороны разъём X1 с другой X2. После подсоединения разъёмов в корпусе БТ, плата КВ будет запаяна в широкую термоусадочную трубку. Максимальное расстояние шлейфа от КВ к точкам подпайки БТ — 10 см. Максимальное расстояние между платами УК и КВ — 30 метров.
Требуется обеспечить гальваническую развязку между устройствами УК и БТ.
Со стороны устройства УК, устройство КВ должно выглядеть как пара обычных электромагнитных реле. В частности, пропускать ток (в обоих направлениях) между контактами C-EN, и C-ONOFF, как если бы к данным контактам были бы подключены обмотки электромагнитного реле. Также «срабатывание» должно происходить при превышении напряжения на контактах C-EN или C-ONOFF выше Von=14Vac (или 20 Vdc). То есть при подаче напряжения ниже данного значения, устройство КВ должно считать что соответствующий выключатель (SW1 или SW2) «разомкнут». При этом устройство КВ должно пропускать ток, как это делала бы катушка электромагнитного реле.

По организации работы см. первый пост в теме.